## 1. Модель даних і зв’язки

Опис сутностей та їх атрибутів:
Users:

- id
- fname
- sname
- email
- password

Superheroes:

- id
- nickname
- real_name
- origin_description
- superpowers
- catch_phrase

Images:

- id
- url
- superhero_id

Favourites:

- id
- user_id
- superhero_id

Зв'язки між сутностями(ER-діаграма):
<img width="961" height="481" alt="node_lab_02 drawio (2)" src="https://github.com/user-attachments/assets/d331c007-422f-489d-a87f-855bd91fb3eb" />
<img width="1081" height="567" alt="ER-diagram_node" src="https://github.com/user-attachments/assets/1adde15a-b95c-4868-93ee-3008325a7375" />

## 2. Компоненти

Діаграма компонентів:
<img width="3340" height="1206" alt="ComponentsDiag_node drawio (3)" src="https://github.com/user-attachments/assets/36aab4c5-bd31-4089-a44f-ff915b6752dc" />

### Router

- **Файли**: `routes/index.js`, `routes/users.js`, `routes/superheroes.js`
- **Призначення**: визначають HTTP-шляхи (`/users/signIn`, `/superheroes`, тощо) та прив’язують їх до відповідних контролерів.
- **Рівень**: вхідна точка для клієнтських запитів.

---

### Middleware (authMiddleware)

Виконується між Router і Controller.
Виконується тільки для маршрутів, де потрібна авторизація.

---

### Controllers

- **Класи**: `UserController`, `SuperheroController`, `FavoritesController`
- **Призначення**: приймають запит від роутера, викликають сервіси, формують відповідь (`res.json(...)`).
- **Рівень**: посередник між HTTP-запитом та бізнес-логікою.

---

### Services (Domain Logic)

- **Класи**: `UserService`, `SuperheroesService`, `FavoritesService`
- **Призначення**: містять бізнес-логіку — робота з БД через моделі, хешування паролів, створення токенів, правила доступу користувачів.
- **Рівень**: “мозок” застосунку.

---

### Models (Sequelize ORM)

- **Файли**: `Users`, `Superheroes`, `Images`, `Favorites`
- **Призначення**: описують структуру таблиць у базі даних та зв’язки між ними.
- **Рівень**: доступ до даних (Data Access Layer).

---

### Database

- **СУБД**: PostgreSQL (через Sequelize)
- **Призначення**: зберігає реальні дані — користувачів, супергероїв, картинки.
- **Рівень**: persistence (довготривале збереження).

---

### Utils

- **Модулі**: `utils/jwt.js`, `bcrypt`
- **Призначення**: допоміжні інструменти для підтримки логіки сервісів (генерація токенів, хешування паролів).
- **Рівень**: загальні утиліти, які можна використовувати в різних сервісах.

---

## Потік даних

1. **Client → Router**: клієнт надсилає HTTP-запит.
2. **Router → Middleware**: якщо маршрут захищений, виконується `authMiddleware` (перевірка JWT, додавання `req.user`).
3. **Middleware → Controller**: якщо авторизація успішна або не потрібна, запит передається далі у відповідний контролер.
4. **Controller → Service**: контролер викликає метод сервісу, передаючи параметри запиту.
5. **Service → Model**: сервіс працює з базою даних через Sequelize-моделі.
6. **Model → Database**: дані читаються або записуються у БД.
7. **Відповідь** повертається назад тим самим шляхом до клієнта.

## 3. Ключові сценарії роботи системи

Сценарій 1. Авторизація користувача

- Запис у Users створюється при реєстрації.
- При логіні перевіряється email + passwordHash.

Сценарій 2. Створення нового супергероя

- У таблицю Superheroes додається запис.
- В Images додаються посилання на зображення.

Сценарій 3. Редагування супергероя

- Оновлюються дані в Superheroes.
- Можливе додавання/видалення/редагування в Images.

Сценарій 4. Видалення супергероя

- Видаляється запис у Superheroes.
- Видаляються пов’язані Images і записи з Favorites.

Сценарій 5. Перегляд списку всіх супергероїв

- Вибірка з Superheroes (id, nickname).
- З Images береться лише одне зображення (наприклад перше).
- Використовується пагінація (5 записів на сторінку).

Сценарій 6. Перегляд деталей одного супергероя

- Вибірка з Superheroes по id.
- З Images вибираються всі зображення.

Сценарій 7. Пошук супергероя

- Пошук Superheroes по nickname.

Сценарій 8. Додавання супергероя в улюблені

- Користувач натискає “В улюблені”.
- У таблицю Favorites додається запис (userId, superheroId).

Сценарій 9. Перегляд улюблених супергероїв користувача

- Вибірка з Favorites по userId.
- Виводиться список обраних героїв.
